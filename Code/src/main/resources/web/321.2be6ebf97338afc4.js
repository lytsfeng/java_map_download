"use strict";(self.webpackChunkWeb=self.webpackChunkWeb||[]).push([[321],{6321:(ml,Se,C)=>{C.r(Se),C.d(Se,{MapModule:()=>cl});var xt=C(6895),I=C(433),Pt=C(3356),we=C(9132);const Ne="object"==typeof global&&global&&global.Object===Object&&global;var Rt="object"==typeof self&&self&&self.Object===Object&&self;const j=Ne||Rt||Function("return this")();var Et=/\s/;var Gt=/^\s+/;const Xt=function Ut(t){return t&&t.slice(0,function Bt(t){for(var e=t.length;e--&&Et.test(t.charAt(e)););return e}(t)+1).replace(Gt,"")},P=function Zt(t){var e=typeof t;return null!=t&&("object"==e||"function"==e)},A=j.Symbol;var Me=Object.prototype,Yt=Me.hasOwnProperty,Vt=Me.toString,V=A?A.toStringTag:void 0;var Jt=Object.prototype.toString;var ve=A?A.toStringTag:void 0;const B=function tr(t){return null==t?void 0===t?"[object Undefined]":"[object Null]":ve&&ve in Object(t)?function Kt(t){var e=Yt.call(t,V),r=t[V];try{t[V]=void 0;var n=!0}catch{}var a=Vt.call(t);return n&&(e?t[V]=r:delete t[V]),a}(t):function Qt(t){return Jt.call(t)}(t)},D=function rr(t){return null!=t&&"object"==typeof t},Ce=function ar(t){return"symbol"==typeof t||D(t)&&"[object Symbol]"==B(t)};var or=/^[-+]0x[0-9a-f]+$/i,sr=/^0b[01]+$/i,ir=/^0o[0-7]+$/i,lr=parseInt;const Ie=function cr(t){if("number"==typeof t)return t;if(Ce(t))return NaN;if(P(t)){var e="function"==typeof t.valueOf?t.valueOf():t;t=P(e)?e+"":e}if("string"!=typeof t)return 0===t?t:+t;t=Xt(t);var r=sr.test(t);return r||ir.test(t)?lr(t.slice(2),r?2:8):or.test(t)?NaN:+t},mr=function pr(t){var e=function gr(t){return t?1/0===(t=Ie(t))||-1/0===t?17976931348623157e292*(t<0?-1:1):t==t?t:0:0===t?t:0}(t),r=e%1;return e==e?r?e-r:e:0},J=Array.isArray;var Oe=A?A.prototype:void 0,Ae=Oe?Oe.toString:void 0;const br=function xe(t){if("string"==typeof t)return t;if(J(t))return function _r(t,e){for(var r=-1,n=null==t?0:t.length,a=Array(n);++r<n;)a[r]=e(t[r],r,t);return a}(t,xe)+"";if(Ce(t))return Ae?Ae.call(t):"";var e=t+"";return"0"==e&&1/t==-1/0?"-0":e},Pe=function Tr(t){return null==t?"":br(t)};var Sr=j.isFinite,wr=Math.min,Mr=function Nr(t){var e=Math[t];return function(r,n){if(r=Ie(r),(n=null==n?0:wr(mr(n),292))&&Sr(r)){var a=(Pe(r)+"e").split("e"),o=e(a[0]+"e"+(+a[1]+n));return+((a=(Pe(o)+"e").split("e"))[0]+"e"+(+a[1]-n))}return e(r)}}("round");const vr=Mr,ze=function Ir(t,e){return t===e||t!=t&&e!=e},Q=function Lr(t,e){for(var r=t.length;r--;)if(ze(t[r][0],e))return r;return-1};var Ar=Array.prototype.splice;function G(t){var e=-1,r=null==t?0:t.length;for(this.clear();++e<r;){var n=t[e];this.set(n[0],n[1])}}G.prototype.clear=function Cr(){this.__data__=[],this.size=0},G.prototype.delete=function xr(t){var e=this.__data__,r=Q(e,t);return!(r<0||(r==e.length-1?e.pop():Ar.call(e,r,1),--this.size,0))},G.prototype.get=function zr(t){var e=this.__data__,r=Q(e,t);return r<0?void 0:e[r][1]},G.prototype.has=function Fr(t){return Q(this.__data__,t)>-1},G.prototype.set=function Br(t,e){var r=this.__data__,n=Q(r,t);return n<0?(++this.size,r.push([t,e])):r[n][1]=e,this};const $=G,Re=function $r(t){if(!P(t))return!1;var e=B(t);return"[object Function]"==e||"[object GeneratorFunction]"==e||"[object AsyncFunction]"==e||"[object Proxy]"==e};var t,qr=j["__core-js_shared__"],Fe=(t=/[^.]+$/.exec(qr&&qr.keys&&qr.keys.IE_PROTO||""))?"Symbol(src)_1."+t:"";var nn=Function.prototype.toString;const z=function an(t){if(null!=t){try{return nn.call(t)}catch{}try{return t+""}catch{}}return""};var sn=/^\[object .+?Constructor\]$/,hn=RegExp("^"+Function.prototype.toString.call(Object.prototype.hasOwnProperty).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");const mn=function pn(t){return!(!P(t)||function en(t){return!!Fe&&Fe in t}(t))&&(Re(t)?hn:sn).test(z(t))},R=function dn(t,e){var r=function _n(t,e){return t?.[e]}(t,e);return mn(r)?r:void 0},K=R(j,"Map"),W=R(Object,"create");var Cn=Object.prototype.hasOwnProperty;var On=Object.prototype.hasOwnProperty;function U(t){var e=-1,r=null==t?0:t.length;for(this.clear();++e<r;){var n=t[e];this.set(n[0],n[1])}}U.prototype.clear=function Tn(){this.__data__=W?W(null):{},this.size=0},U.prototype.delete=function wn(t){var e=this.has(t)&&delete this.__data__[t];return this.size-=e?1:0,e},U.prototype.get=function jn(t){var e=this.__data__;if(W){var r=e[t];return"__lodash_hash_undefined__"===r?void 0:r}return Cn.call(e,t)?e[t]:void 0},U.prototype.has=function An(t){var e=this.__data__;return W?void 0!==e[t]:On.call(e,t)},U.prototype.set=function zn(t,e){var r=this.__data__;return this.size+=this.has(t)?0:1,r[t]=W&&void 0===e?"__lodash_hash_undefined__":e,this};const Ee=U,q=function Gn(t,e){var r=t.__data__;return function Bn(t){var e=typeof t;return"string"==e||"number"==e||"symbol"==e||"boolean"==e?"__proto__"!==t:null===t}(e)?r["string"==typeof e?"string":"hash"]:r.map};function X(t){var e=-1,r=null==t?0:t.length;for(this.clear();++e<r;){var n=t[e];this.set(n[0],n[1])}}X.prototype.clear=function Fn(){this.size=0,this.__data__={hash:new Ee,map:new(K||$),string:new Ee}},X.prototype.delete=function Un(t){var e=q(this,t).delete(t);return this.size-=e?1:0,e},X.prototype.get=function Zn(t){return q(this,t).get(t)},X.prototype.has=function Yn(t){return q(this,t).has(t)},X.prototype.set=function Kn(t,e){var r=q(this,t),n=r.size;return r.set(t,e),this.size+=r.size==n?0:1,this};const Hn=X;function Z(t){var e=this.__data__=new $(t);this.size=e.size}Z.prototype.clear=function Gr(){this.__data__=new $,this.size=0},Z.prototype.delete=function Xr(t){var e=this.__data__,r=e.delete(t);return this.size=e.size,r},Z.prototype.get=function kr(t){return this.__data__.get(t)},Z.prototype.has=function Vr(t){return this.__data__.has(t)},Z.prototype.set=function Qn(t,e){var r=this.__data__;if(r instanceof $){var n=r.__data__;if(!K||n.length<199)return n.push([t,e]),this.size=++r.size,this;r=this.__data__=new Hn(n)}return r.set(t,e),this.size=r.size,this};const qn=Z;var ra=function(){try{var t=R(Object,"defineProperty");return t({},"",{}),t}catch{}}();const Be=ra,De=function na(t,e,r){"__proto__"==e&&Be?Be(t,e,{configurable:!0,enumerable:!0,value:r,writable:!0}):t[e]=r};var oa=Object.prototype.hasOwnProperty;const Ge=function sa(t,e,r){var n=t[e];(!oa.call(t,e)||!ze(n,r)||void 0===r&&!(e in t))&&De(t,e,r)},ee=function ia(t,e,r,n){var a=!r;r||(r={});for(var o=-1,s=e.length;++o<s;){var l=e[o],c=n?n(r[l],t[l],l,r,t):void 0;void 0===c&&(c=t[l]),a?De(r,l,c):Ge(r,l,c)}return r},Ue=function ga(t){return D(t)&&"[object Arguments]"==B(t)};var Xe=Object.prototype,ha=Xe.hasOwnProperty,pa=Xe.propertyIsEnumerable,ma=Ue(function(){return arguments}())?Ue:function(t){return D(t)&&ha.call(t,"callee")&&!pa.call(t,"callee")};const _a=ma;var Ze="object"==typeof exports&&exports&&!exports.nodeType&&exports,ke=Ze&&"object"==typeof module&&module&&!module.nodeType&&module,Ye=ke&&ke.exports===Ze?j.Buffer:void 0;const Ve=(Ye?Ye.isBuffer:void 0)||function fa(){return!1};var wa=/^(?:0|[1-9]\d*)$/;const Ma=function Na(t,e){var r=typeof t;return!!(e=e??9007199254740991)&&("number"==r||"symbol"!=r&&wa.test(t))&&t>-1&&t%1==0&&t<e},Ke=function Ca(t){return"number"==typeof t&&t>-1&&t%1==0&&t<=9007199254740991};var w={};w["[object Float32Array]"]=w["[object Float64Array]"]=w["[object Int8Array]"]=w["[object Int16Array]"]=w["[object Int32Array]"]=w["[object Uint8Array]"]=w["[object Uint8ClampedArray]"]=w["[object Uint16Array]"]=w["[object Uint32Array]"]=!0,w["[object Arguments]"]=w["[object Array]"]=w["[object ArrayBuffer]"]=w["[object Boolean]"]=w["[object DataView]"]=w["[object Date]"]=w["[object Error]"]=w["[object Function]"]=w["[object Map]"]=w["[object Number]"]=w["[object Object]"]=w["[object RegExp]"]=w["[object Set]"]=w["[object String]"]=w["[object WeakMap]"]=!1;const se=function qa(t){return function(e){return t(e)}};var We="object"==typeof exports&&exports&&!exports.nodeType&&exports,H=We&&"object"==typeof module&&module&&!module.nodeType&&module,ie=H&&H.exports===We&&Ne.process;const k=function(){try{return H&&H.require&&H.require("util").types||ie&&ie.binding&&ie.binding("util")}catch{}}();var He=k&&k.isTypedArray;const no=He?se(He):function Qa(t){return D(t)&&Ke(t.length)&&!!w[B(t)]};var oo=Object.prototype.hasOwnProperty;const Je=function so(t,e){var r=J(t),n=!r&&_a(t),a=!r&&!n&&Ve(t),o=!r&&!n&&!a&&no(t),s=r||n||a||o,l=s?function la(t,e){for(var r=-1,n=Array(t);++r<t;)n[r]=e(r);return n}(t.length,String):[],c=l.length;for(var u in t)(e||oo.call(t,u))&&(!s||!("length"==u||a&&("offset"==u||"parent"==u)||o&&("buffer"==u||"byteLength"==u||"byteOffset"==u)||Ma(u,c)))&&l.push(u);return l};var io=Object.prototype;const le=function lo(t){var e=t&&t.constructor;return t===("function"==typeof e&&e.prototype||io)},Qe=function co(t,e){return function(r){return t(e(r))}},go=Qe(Object.keys,Object);var po=Object.prototype.hasOwnProperty;const $e=function fo(t){return null!=t&&Ke(t.length)&&!Re(t)},ce=function yo(t){return $e(t)?Je(t):function mo(t){if(!le(t))return go(t);var e=[];for(var r in Object(t))po.call(t,r)&&"constructor"!=r&&e.push(r);return e}(t)};var Mo=Object.prototype.hasOwnProperty;const Co=function vo(t){if(!P(t))return function So(t){var e=[];if(null!=t)for(var r in Object(t))e.push(r);return e}(t);var e=le(t),r=[];for(var n in t)"constructor"==n&&(e||!Mo.call(t,n))||r.push(n);return r},ue=function jo(t){return $e(t)?Je(t,!0):Co(t)};var qe="object"==typeof exports&&exports&&!exports.nodeType&&exports,et=qe&&"object"==typeof module&&module&&!module.nodeType&&module,tt=et&&et.exports===qe?j.Buffer:void 0,rt=tt?tt.allocUnsafe:void 0;const nt=function Eo(){return[]};var Do=Object.prototype.propertyIsEnumerable,at=Object.getOwnPropertySymbols,Go=at?function(t){return null==t?[]:(t=Object(t),function Ro(t,e){for(var r=-1,n=null==t?0:t.length,a=0,o=[];++r<n;){var s=t[r];e(s,r,t)&&(o[a++]=s)}return o}(at(t),function(e){return Do.call(t,e)}))}:nt;const ge=Go,ot=function Zo(t,e){for(var r=-1,n=e.length,a=t.length;++r<n;)t[a+r]=e[r];return t},st=Qe(Object.getPrototypeOf,Object);var Vo=Object.getOwnPropertySymbols?function(t){for(var e=[];t;)ot(e,ge(t)),t=st(t);return e}:nt;const it=Vo,lt=function Ho(t,e,r){var n=e(t);return J(t)?n:ot(n,r(t))},Qo=function Jo(t){return lt(t,ce,ge)},qo=function $o(t){return lt(t,ue,it)},he=R(j,"DataView"),pe=R(j,"Promise"),me=R(j,"Set"),_e=R(j,"WeakMap");var ct="[object Map]",ut="[object Promise]",gt="[object Set]",ht="[object WeakMap]",pt="[object DataView]",os=z(he),ss=z(K),is=z(pe),ls=z(me),cs=z(_e),F=B;(he&&F(new he(new ArrayBuffer(1)))!=pt||K&&F(new K)!=ct||pe&&F(pe.resolve())!=ut||me&&F(new me)!=gt||_e&&F(new _e)!=ht)&&(F=function(t){var e=B(t),r="[object Object]"==e?t.constructor:void 0,n=r?z(r):"";if(n)switch(n){case os:return pt;case ss:return ct;case is:return ut;case ls:return gt;case cs:return ht}return e});const fe=F;var gs=Object.prototype.hasOwnProperty;const mt=j.Uint8Array,de=function _s(t){var e=new t.constructor(t.byteLength);return new mt(e).set(new mt(t)),e};var ys=/\w*$/;var _t=A?A.prototype:void 0,ft=_t?_t.valueOf:void 0;const Ys=function ks(t,e,r){var n=t.constructor;switch(e){case"[object ArrayBuffer]":return de(t);case"[object Boolean]":case"[object Date]":return new n(+t);case"[object DataView]":return function fs(t,e){var r=e?de(t.buffer):t.buffer;return new t.constructor(r,t.byteOffset,t.byteLength)}(t,r);case"[object Float32Array]":case"[object Float64Array]":case"[object Int8Array]":case"[object Int16Array]":case"[object Int32Array]":case"[object Uint8Array]":case"[object Uint8ClampedArray]":case"[object Uint16Array]":case"[object Uint32Array]":return function Ns(t,e){var r=e?de(t.buffer):t.buffer;return new t.constructor(r,t.byteOffset,t.length)}(t,r);case"[object Map]":case"[object Set]":return new n;case"[object Number]":case"[object String]":return new n(t);case"[object RegExp]":return function bs(t){var e=new t.constructor(t.source,ys.exec(t));return e.lastIndex=t.lastIndex,e}(t);case"[object Symbol]":return function Ss(t){return ft?Object(ft.call(t)):{}}(t)}};var dt=Object.create,Vs=function(){function t(){}return function(e){if(!P(e))return{};if(dt)return dt(e);t.prototype=e;var r=new t;return t.prototype=void 0,r}}();const Ks=Vs;var yt=k&&k.isMap;const ei=yt?se(yt):function Qs(t){return D(t)&&"[object Map]"==fe(t)};var bt=k&&k.isSet;const oi=bt?se(bt):function ri(t){return D(t)&&"[object Set]"==fe(t)};var Tt="[object Arguments]",St="[object Function]",wt="[object Object]",S={};S[Tt]=S["[object Array]"]=S["[object ArrayBuffer]"]=S["[object DataView]"]=S["[object Boolean]"]=S["[object Date]"]=S["[object Float32Array]"]=S["[object Float64Array]"]=S["[object Int8Array]"]=S["[object Int16Array]"]=S["[object Int32Array]"]=S["[object Map]"]=S["[object Number]"]=S[wt]=S["[object RegExp]"]=S["[object Set]"]=S["[object String]"]=S["[object Symbol]"]=S["[object Uint8Array]"]=S["[object Uint8ClampedArray]"]=S["[object Uint16Array]"]=S["[object Uint32Array]"]=!0,S["[object Error]"]=S[St]=S["[object WeakMap]"]=!1;const xi=function te(t,e,r,n,a,o){var s,l=1&e,c=2&e,u=4&e;if(r&&(s=a?r(t,n,a,o):r(t)),void 0!==s)return s;if(!P(t))return t;var i=J(t);if(i){if(s=function hs(t){var e=t.length,r=new t.constructor(e);return e&&"string"==typeof t[0]&&gs.call(t,"index")&&(r.index=t.index,r.input=t.input),r}(t),!l)return function Po(t,e){var r=-1,n=t.length;for(e||(e=Array(n));++r<n;)e[r]=t[r];return e}(t,s)}else{var p=fe(t),h=p==St||"[object GeneratorFunction]"==p;if(Ve(t))return function Ao(t,e){if(e)return t.slice();var r=t.length,n=rt?rt(r):new t.constructor(r);return t.copy(n),n}(t,l);if(p==wt||p==Tt||h&&!a){if(s=c||h?{}:function Ws(t){return"function"!=typeof t.constructor||le(t)?{}:Ks(st(t))}(t),!l)return c?function Ko(t,e){return ee(t,it(t),e)}(t,function Io(t,e){return t&&ee(e,ue(e),t)}(s,t)):function Uo(t,e){return ee(t,ge(t),e)}(t,function bo(t,e){return t&&ee(e,ce(e),t)}(s,t))}else{if(!S[p])return a?t:{};s=Ys(t,p,l)}}o||(o=new qn);var T=o.get(t);if(T)return T;o.set(t,s),oi(t)?t.forEach(function(b){s.add(te(b,e,r,b,t,o))}):ei(t)&&t.forEach(function(b,_){s.set(_,te(b,e,r,_,t,o))});var f=i?void 0:(u?c?qo:Qo:c?ue:ce)(t);return function ea(t,e){for(var r=-1,n=null==t?0:t.length;++r<n&&!1!==e(t[r],r,t););}(f||t,function(b,_){f&&(b=t[_=b]),Ge(s,_,te(b,e,r,_,t,o))}),s};class N{static getMapType(e){switch(e){case"OpenStreet":return"OpenStreet";case"Google-Normal":return"\u8c37\u6b4c\u5730\u56fe\uff08\u666e\u901a\u5e26\u6807\u6ce8\uff09";case"Google-Terrain":return"\u8c37\u6b4c\u5730\u56fe\uff08\u5730\u5f62\u5e26\u6807\u6ce8\uff09";case"Google-Satellite":return"\u8c37\u6b4c\u5730\u56fe\uff08\u5f71\u50cf\u5e26\u6807\u6ce8\uff09";case"Google-Satellite-None":return"\u8c37\u6b4c\u5730\u56fe\uff08\u5f71\u50cf\u65e0\u6807\u6ce8\uff09";case"Google-Street":return"\u8c37\u6b4c\u5730\u56fe\uff08\u8def\u7f51\u5e26\u6807\u6ce8\uff09";case"AMap-Normal":return"\u9ad8\u5fb7\u5730\u56fe\uff08\u666e\u901a\u5e26\u6807\u6ce8\uff09";case"AMap-Normal-None":return"\u9ad8\u5fb7\u5730\u56fe\uff08\u666e\u901a\u65e0\u6807\u6ce8\uff09";case"AMap-Satellite-None":return"\u9ad8\u5fb7\u5730\u56fe\uff08\u5f71\u50cf\u65e0\u6807\u6ce8\uff09";case"AMap-Street":return"\u9ad8\u5fb7\u5730\u56fe\uff08\u8def\u7f51\u5e26\u6807\u6ce8\uff09";case"AMap-Street-None":return"\u9ad8\u5fb7\u5730\u56fe\uff08\u8def\u7f51\u65e0\u6807\u6ce8\uff09";case"Tencent-Normal":return"\u817e\u8baf\u5730\u56fe\uff08\u666e\u901a\u5e26\u6807\u6ce8\uff09";case"Tianditu-Normal-None":return"\u5929\u5730\u56fe\uff08\u666e\u901a\u65e0\u6807\u6ce8\uff09";case"Tianditu-Terrain-None":return"\u5929\u5730\u56fe\uff08\u5730\u5f62\u65e0\u6807\u6ce8\uff09";case"Tianditu-Line":return"\u5929\u5730\u56fe\uff08\u8fb9\u754c\u65e0\u6807\u6ce8\uff09";case"Tianditu-Tip":return"\u5929\u5730\u56fe\uff08\u6807\u6ce8\u5c42\uff09";case"Bing-Normal-1":return"\u5fc5\u5e94\u5730\u56fe\uff08\u666e\u901a1\u5e26\u6807\u6ce8-\u5168\u7403\uff09";case"Bing-Normal-1-CN":return"\u5fc5\u5e94\u5730\u56fe\uff08\u666e\u901a1\u5e26\u6807\u6ce8-\u56fd\u5185\uff09";case"Bing-Normal-1-None":return"\u5fc5\u5e94\u5730\u56fe\uff08\u666e\u901a1\u65e0\u6807\u6ce8\uff09";case"Bing-Normal-2":return"\u5fc5\u5e94\u5730\u56fe\uff08\u666e\u901a2\u5e26\u6807\u6ce8-\u5168\u7403\uff09";case"Bing-Normal-2-CN":return"\u5fc5\u5e94\u5730\u56fe\uff08\u666e\u901a2\u5e26\u6807\u6ce8-\u56fd\u5185\uff09";case"Bing-Normal-2-None":return"\u5fc5\u5e94\u5730\u56fe\uff08\u666e\u901a2\u65e0\u6807\u6ce8\uff09";case"Bing-Satellite":return"\u5fc5\u5e94\u5730\u56fe\uff08\u5f71\u50cf\u5e26\u6807\u6ce8-\u5168\u7403\uff09";case"Bing-Satellite-CN":return"\u5fc5\u5e94\u5730\u56fe\uff08\u5f71\u50cf\u5e26\u6807\u6ce8-\u56fd\u5185\uff09";case"Bing-Satellite-None":return"\u5fc5\u5e94\u5730\u56fe\uff08\u5f71\u50cf\u65e0\u6807\u6ce8\uff09";default:return"NOSUPPORT"}}static needKey(e){return 0==e?.indexOf("Tianditu")?{type:"tian",has:!0}:{type:"",has:!1}}static setConfigCache(e){localStorage.setItem("jmd-config",JSON.stringify(e))}static getConfigCache(){let e,r;return e=localStorage.getItem("jmd-config"),r=e&&""!=e?JSON.parse(e):{layer:"AMap-Normal",grid:!0,key:{tian:"81dd3e1715be9d296f1a9f2b0c0196aa"}},r}static removeConfigCache(){localStorage.removeItem("jmd-config")}static randomNum(e,r){switch(arguments.length){case 1:return parseInt((Math.random()*e+1).toString(),10);case 2:return parseInt((Math.random()*(r-e+1)+e).toString(),10);default:return 0}}static round(e,r){return vr(e,r)}static cloneDeep(e){return function Ri(t){return xi(t,5)}(e)}}class Ei{constructor(e){const r="https://{a-c}.tile.openstreetmap.org/{z}/{x}/{y}.png";this.OpenStreetMap_Name="OpenStreet",this.OpenStreetMap_Source=[{name:"Normal",type:"XYZ_URL",support:!0,source:new e.source.XYZ({url:r}),url:r,coordinateType:"wgs84"}]}}class Bi{constructor(e){const r="https://t{0-7}.tianditu.gov.cn/vec_w/wmts?SERVICE=WMTS&REQUEST=GetTile&VERSION=1.0.0&LAYER=vec&STYLE=default&TILEMATRIXSET=w&FORMAT=tiles&TILECOL={x}&TILEROW={y}&TILEMATRIX={z}&tk=&&&&&&&key&&&&&&&";this.TiandituNormalNone_Name="Tianditu-Normal-None",this.TiandituNormalNone_Source=[{name:"Normal-None",type:"XYZ_URL",support:!0,source:new e.source.XYZ({url:r.replace("&&&&&&&key&&&&&&&",N.getConfigCache().key.tian)}),url:r,coordinateType:"wgs84"}];const n="https://t{0-7}.tianditu.gov.cn/ter_w/wmts?SERVICE=WMTS&REQUEST=GetTile&VERSION=1.0.0&LAYER=ter&STYLE=default&TILEMATRIXSET=w&FORMAT=tiles&TILECOL={x}&TILEROW={y}&TILEMATRIX={z}&tk=&&&&&&&key&&&&&&&";this.TiandituTerrainNone_Name="Tianditu-Terrain-None",this.TiandituTerrainNone_Source=[{name:"Terrain-None",type:"XYZ_URL",support:!0,source:new e.source.XYZ({url:n.replace("&&&&&&&key&&&&&&&",N.getConfigCache().key.tian)}),url:n,coordinateType:"wgs84"}];const a="https://t{0-7}.tianditu.gov.cn/ibo_w/wmts?SERVICE=WMTS&REQUEST=GetTile&VERSION=1.0.0&LAYER=ibo&STYLE=default&TILEMATRIXSET=w&FORMAT=tiles&TILECOL={x}&TILEROW={y}&TILEMATRIX={z}&tk=&&&&&&&key&&&&&&&";this.TiandituLine_Name="Tianditu-Line",this.TiandituLine_Source=[{name:"Normal-Tip",type:"XYZ_URL",support:!0,source:new e.source.XYZ({url:a.replace("&&&&&&&key&&&&&&&",N.getConfigCache().key.tian)}),url:a,coordinateType:"wgs84"}];const o="https://t{0-7}.tianditu.gov.cn/cva_w/wmts?SERVICE=WMTS&REQUEST=GetTile&VERSION=1.0.0&LAYER=cva&STYLE=default&TILEMATRIXSET=w&FORMAT=tiles&TILECOL={x}&TILEROW={y}&TILEMATRIX={z}&tk=&&&&&&&key&&&&&&&";this.TiandituTip_Name="Tianditu-Tip",this.TiandituTip_Source=[{name:"Normal-Tip",type:"XYZ_URL",support:!0,source:new e.source.XYZ({url:o.replace("&&&&&&&key&&&&&&&",N.getConfigCache().key.tian)}),url:o,coordinateType:"wgs84"}]}}class Di{constructor(e){const r="https://mt{1-3}.google.com/maps/vt?lyrs=m%40781&hl=zh-CN&gl=CN&x={x}&y={y}&z={z}";this.GoogleNormal_Name="Google-Normal",this.GoogleNormal_Source=[{name:"Normal",type:"XYZ_URL",support:!0,source:new e.source.XYZ({url:r}),url:r,coordinateType:"gcj02"}];const n="https://mt{1-3}.google.com/maps/vt?lyrs=p%40781&hl=zh-CN&gl=CN&x={x}&y={y}&z={z}";this.GoogleTerrain_Name="Google-Terrain",this.GoogleTerrain_Source=[{name:"Terrain",type:"XYZ_URL",support:!0,source:new e.source.XYZ({url:n}),url:n,coordinateType:"gcj02"}];const a="https://mt{1-3}.google.com/maps/vt?lyrs=y%40781&hl=zh-CN&gl=CN&x={x}&y={y}&z={z}";this.GoogleSatellite_Name="Google-Satellite",this.GoogleSatellite_Source=[{name:"Satellite",type:"XYZ_URL",support:!0,source:new e.source.XYZ({url:a}),url:a,coordinateType:"gcj02"}];const o="https://mt{1-3}.google.com/maps/vt?lyrs=s%40781&hl=zh-CN&gl=CN&x={x}&y={y}&z={z}";this.GoogleSatelliteNone_Name="Google-Satellite-None",this.GoogleSatelliteNone_Source=[{name:"Satellite-None",type:"XYZ_URL",support:!0,source:new e.source.XYZ({url:o}),url:o,coordinateType:"gcj02"}];const s="https://mt{1-3}.google.com/maps/vt?lyrs=h%40781&hl=zh-CN&gl=CN&x={x}&y={y}&z={z}";this.GoogleStreet_Name="Google-Street",this.GoogleStreet_Source=[{name:"Street",type:"XYZ_URL",support:!0,source:new e.source.XYZ({url:s}),url:s,coordinateType:"gcj02"}]}}class Gi{constructor(e){const r="https://webrd0{1-4}.is.autonavi.com/appmaptile?x={x}&y={y}&z={z}&lang=zh_cn&size=1&scl=1&style=8";this.AMapNormal_Name="AMap-Normal",this.AMapNormal_Source=[{name:"Normal",type:"XYZ_URL",support:!0,source:new e.source.XYZ({url:r}),url:r,coordinateType:"gcj02"}];const n="https://webrd0{1-4}.is.autonavi.com/appmaptile?x={x}&y={y}&z={z}&lang=zh_cn&size=1&scl=1&style=8&ltype=11";this.AMapNormalNone_Name="AMap-Normal-None",this.AMapNormalNone_Source=[{name:"Normal-None",type:"XYZ_URL",support:!0,source:new e.source.XYZ({url:n}),url:n,coordinateType:"gcj02"}];const a="https://webst0{1-4}.is.autonavi.com/appmaptile?x={x}&y={y}&z={z}&lang=zh_cn&size=1&scl=1&style=6";this.AMapSatelliteNone_Name="AMap-Satellite-None",this.AMapSatelliteNone_Source=[{name:"Satellite-None",type:"XYZ_URL",support:!0,source:new e.source.XYZ({url:a}),url:a,coordinateType:"gcj02"}];const o="https://webst0{1-4}.is.autonavi.com/appmaptile?x={x}&y={y}&z={z}&lang=zh_cn&size=1&scl=1&style=8";this.AMapStreet_Name="AMap-Street",this.AMapStreet_Source=[{name:"Street",type:"XYZ_URL",support:!0,source:new e.source.XYZ({url:o}),url:o,coordinateType:"gcj02"}];const s="https://webst0{1-4}.is.autonavi.com/appmaptile?x={x}&y={y}&z={z}&lang=zh_cn&size=1&scl=1&style=8&ltype=11";this.AMapStreetNone_Name="AMap-Street-None",this.AMapStreetNone_Source=[{name:"Street-None",type:"XYZ_URL",support:!0,source:new e.source.XYZ({url:s}),url:s,coordinateType:"gcj02"}]}}class Ui{constructor(e){const r="http://rt0.map.gtimg.com/realtimerender?z={z}&x={x}&y={-y}&type=vector&style=0";this.TencentNormal_Name="Tencent-Normal",this.TencentNormal_Source=[{name:"Normal",type:"XYZ_URL",support:!0,source:new e.source.XYZ({url:r}),url:r,coordinateType:"gcj02"}]}}class Xi{constructor(e){const r=(i,p)=>{let h="",T=i[0],m=i[1]+1,f=i[2]+1,b=Math.pow(2,T);for(let _=1;_<=T;_++){let M=b/Math.pow(2,_-1);m/M<=.5&&f/M<=.5&&(h+="0"),m/M>.5&&f/M<=.5&&(h+="1",m-=M/2),m/M<=.5&&f/M>.5&&(h+="2",f-=M/2),m/M>.5&&f/M>.5&&(h+="3",m-=M/2,f-=M/2)}return p.replace("{0-1}",Math.random()>.5?"0":"1").replace("{&&&&&}",h)},n="https://t{0-1}.dynamic.tiles.ditu.live.com/comp/ch/{&&&&&}?mkt=zh-cn&n=z&it=G,TW,L&og=503&cstl=rd";this.BingMapNormal1_Name="Bing-Normal-1",this.BingMapNormal1_Source=[{name:"Normal",type:"XYZ_URL",support:!0,source:new e.source.TileImage({projection:"EPSG:3857",tileUrlFunction:(i,p,h)=>r(i,n)}),url:n,coordinateType:"gcj02"}];const a="https://t{0-1}.dynamic.tiles.ditu.live.com/comp/ch/{&&&&&}?mkt=zh-cn&n=z&ur=CN&it=G,TW,L&og=503&cstl=rd";this.BingMapNormal1CN_Name="Bing-Normal-1-CN",this.BingMapNormal1CN_Source=[{name:"Normal",type:"XYZ_URL",support:!0,source:new e.source.TileImage({projection:"EPSG:3857",tileUrlFunction:(i,p,h)=>r(i,a)}),url:a,coordinateType:"gcj02"}];const o="https://t{0-1}.dynamic.tiles.ditu.live.com/comp/ch/{&&&&&}?mkt=zh-cn&n=z&it=G,TW,RL&og=503&cstl=rd";this.BingMapNormal1None_Name="Bing-Normal-1-None",this.BingMapNormal1None_Source=[{name:"Normal-None",type:"XYZ_URL",support:!0,source:new e.source.TileImage({projection:"EPSG:3857",tileUrlFunction:(i,p,h)=>r(i,o)}),url:o,coordinateType:"gcj02"}];let s="https://t{0-1}.dynamic.tiles.ditu.live.com/comp/ch/{&&&&&}?mkt=zh-cn&n=z&it=G,TW,L&og=503&cstl=vb";this.BingMapNormal2_Name="Bing-Normal-2",this.BingMapNormal2_Source=[{name:"Normal",type:"XYZ_URL",support:!0,source:new e.source.TileImage({projection:"EPSG:3857",tileUrlFunction:(i,p,h)=>r(i,s)}),url:s,coordinateType:"gcj02"}];let l="https://t{0-1}.dynamic.tiles.ditu.live.com/comp/ch/{&&&&&}?mkt=zh-cn&n=z&ur=CN&it=G,TW,L&og=503&cstl=vb";this.BingMapNormal2CN_Name="Bing-Normal-2-CN",this.BingMapNormal2CN_Source=[{name:"Normal",type:"XYZ_URL",support:!0,source:new e.source.TileImage({projection:"EPSG:3857",tileUrlFunction:(i,p,h)=>r(i,l)}),url:l,coordinateType:"gcj02"}];let c="https://t{0-1}.dynamic.tiles.ditu.live.com/comp/ch/{&&&&&}?mkt=zh-cn&n=z&it=G,TW,RL&og=503&cstl=vb";this.BingMapNormal2None_Name="Bing-Normal-2-None",this.BingMapNormal2None_Source=[{name:"Normal-None",type:"XYZ_URL",support:!0,source:new e.source.TileImage({projection:"EPSG:3857",tileUrlFunction:(i,p,h)=>r(i,c)}),url:c,coordinateType:"gcj02"}];let u="https://t{0-1}.dynamic.tiles.ditu.live.com/comp/ch/{&&&&&}?mkt=zh-cn&n=z&it=A&src=o&og=503";this.BingMapSatelliteNone_Name="Bing-Satellite-None",this.BingMapSatelliteNone_Source=[{name:"Satellite-None",type:"XYZ_URL",support:!0,source:new e.source.TileImage({projection:"EPSG:3857",tileUrlFunction:(i,p,h)=>r(i,u)}),url:u,coordinateType:"wgs84"}]}}class Zi{constructor(e){const r=[];for(let s=0;s<=8;++s)r.push(156543.03392804097/Math.pow(2,2*s));const o="https://{a-d}.tiles.mapbox.com/v4/mapbox.mapbox-streets-v6/{z}/{x}/{y}.vector.pbf?access_token=pk.eyJ1IjoiaDYzMjU4MjE4MyIsImEiOiJjbDl6dHg4NmMwajI1M29uejc0bWV2ZHdvIn0.Zk2n4LahjuKP3TG8ih6iCg";this.MapBoxPDF_Name="MapBox-PDF",this.MapBoxPDF_Source=[{name:"MapBox",type:"PDF",support:!0,source:new e.source.VectorTile({attributions:'\xa9 <a href="https://www.mapbox.com/map-feedback/">Mapbox</a> \xa9 <a href="https://www.openstreetmap.org/copyright">OpenStreetMap contributors</a>',format:new e.format.MVT,tileGrid:new e.tilegrid.TileGrid({extent:e.proj.get("EPSG:3857").getExtent(),resolutions:r,tileSize:512}),tileUrlFunction:s=>o.replace("{z}",String(2*s[0]-1)).replace("{x}",String(s[1])).replace("{y}",String(s[2])).replace("{a-d}","abcd".substr(((s[1]<<s[0])+s[2])%4,1))}),url:o,coordinateType:"gcj02"}]}}class ki{constructor(e){const r=[];for(let a=0;a<19;a++)r[a]=Math.pow(2,18-a);const n=new e.tilegrid.TileGrid({origin:[0,0],resolutions:r});this.BaiduNormal_Name="Baidu-Normal",this.BaiduNormal_Source=[{name:"Normal",type:"TILE_FUNC",support:!1,source:new e.source.TileImage({projection:"EPSG:3857",tileGrid:n,tileUrlFunction:(a,o,s)=>{if(!a)return"";let l=String(a[0]),c=String(a[1]),u=String(-a[2]-1);return Number(c)<0&&(c="M"+-Number(c)),Number(u)<0&&(u="M"+-Number(u)),"http://online1.map.bdimg.com/onlinelabel/?qt=tile&x="+c+"&y="+u+"&z="+l+"&styles=pl&scaler=1&p=1"}})}]}}class Yi{constructor(e){this.layers=new Map;let r=new Ei(e);this.layers.set(r.OpenStreetMap_Name,r.OpenStreetMap_Source);let n=new Bi(e);this.layers.set(n.TiandituNormalNone_Name,n.TiandituNormalNone_Source),this.layers.set(n.TiandituTerrainNone_Name,n.TiandituTerrainNone_Source),this.layers.set(n.TiandituLine_Name,n.TiandituLine_Source),this.layers.set(n.TiandituTip_Name,n.TiandituTip_Source);let a=new Di(e);this.layers.set(a.GoogleNormal_Name,a.GoogleNormal_Source),this.layers.set(a.GoogleTerrain_Name,a.GoogleTerrain_Source),this.layers.set(a.GoogleSatellite_Name,a.GoogleSatellite_Source),this.layers.set(a.GoogleSatelliteNone_Name,a.GoogleSatelliteNone_Source),this.layers.set(a.GoogleStreet_Name,a.GoogleStreet_Source);let o=new Gi(e);this.layers.set(o.AMapNormal_Name,o.AMapNormal_Source),this.layers.set(o.AMapNormalNone_Name,o.AMapNormalNone_Source),this.layers.set(o.AMapSatelliteNone_Name,o.AMapSatelliteNone_Source),this.layers.set(o.AMapStreet_Name,o.AMapStreet_Source),this.layers.set(o.AMapStreetNone_Name,o.AMapStreetNone_Source);let s=new Ui(e);this.layers.set(s.TencentNormal_Name,s.TencentNormal_Source);let l=new Xi(e);this.layers.set(l.BingMapNormal1_Name,l.BingMapNormal1_Source),this.layers.set(l.BingMapNormal1CN_Name,l.BingMapNormal1CN_Source),this.layers.set(l.BingMapNormal1None_Name,l.BingMapNormal1None_Source),this.layers.set(l.BingMapNormal2_Name,l.BingMapNormal2_Source),this.layers.set(l.BingMapNormal2CN_Name,l.BingMapNormal2CN_Source),this.layers.set(l.BingMapNormal2None_Name,l.BingMapNormal2None_Source),this.layers.set(l.BingMapSatelliteNone_Name,l.BingMapSatelliteNone_Source);let c=new Zi(e);this.layers.set(c.MapBoxPDF_Name,c.MapBoxPDF_Source);let u=new ki(e);this.layers.set(u.BaiduNormal_Name,u.BaiduNormal_Source)}}class d{constructor(e,r){this.lng=e,this.lat=r}equals(e){return this.lng==e.lng&&this.lat==e.lat}}class re{constructor(e,r){this.lng=e,this.lat=r}}class ne{constructor(e,r){this.lng={h:e.h,m:e.m,s:e.s},this.lat={h:r.h,m:r.m,s:r.s}}valid(){return null!=this.lng.h&&null!=this.lng.m&&null!=this.lng.s&&null!=this.lat.h&&null!=this.lat.m&&null!=this.lat.s&&this.lng.h>-180&&this.lng.h<180&&this.lng.m>=0&&this.lng.m<60&&this.lng.s>=0&&this.lng.s<60&&this.lat.h>-90&&this.lat.h<90&&this.lat.m>=0&&this.lat.m<60&&this.lat.s>=0&&this.lat.s<60}}class y{static getCirclePoints(e,r){let a=2*Math.PI/72,o=[];for(let s=0;s<72;s++){let l=r*Math.cos(s*a),c=r*Math.sin(s*a),u=l/(y.EARTH_RADIUS*Math.cos(e.lat*Math.PI/180)*Math.PI/180),i=c/(y.EARTH_RADIUS*Math.PI/180);o.push(new d(e.lng+u,e.lat+i))}return o}static ensString2EnPointObj(e){let r;if(r=0==e.indexOf("E")?new re(e.split(",")[0],e.split(",")[1]):new re(e.split(",")[1],e.split(",")[0]),null==r.lng||""==r.lng||null==r.lat||""==r.lat)return new ne({h:0,m:0,s:0},{h:0,m:0,s:0});let n=r.lng.split("E")[1],a=Number(n.split("\xb0")[0]),o=Number(n.split("\xb0")[1].split("\u2032")[0]),s=Number(n.split("\xb0")[1].split("\u2032")[1].split("\u2033")[0]),l=r.lat.split("N")[1],c=Number(l.split("\xb0")[0]),u=Number(l.split("\xb0")[1].split("\u2032")[0]),i=Number(l.split("\xb0")[1].split("\u2032")[1].split("\u2033")[0]),p=new ne({h:a,m:o,s:Number(s)},{h:c,m:u,s:Number(i)});return p.valid()?p:new ne({h:0,m:0,s:0},{h:0,m:0,s:0})}static lnglat2ENPoint(e){let r=~~e.lng,n=~~(60*(e.lng-r)),o=N.round(60*(60*(e.lng-r)-n),1);o>=60&&(n+=1,o-=60),n>=60&&(r+=1,n-=60);let s="E"+r+"\xb0"+n+"\u2032"+o+"\u2033",l=~~e.lat,c=~~(60*(e.lat-l)),i=N.round(60*(60*(e.lat-l)-c),1);return i>=60&&(c+=1,i-=60),c>=60&&(l+=1,c-=60),new re(s,"N"+l+"\xb0"+c+"\u2032"+i+"\u2033")}static lnglat2ENPointFix0(e){let s,l,r=~~e.lng,n=~~(60*(e.lng-r)),o=N.round(60*(60*(e.lng-r)-n),1);o>=60&&(n+=1,o-=60),n>=60&&(r+=1,n-=60),s=n<10?"0"+n:""+n,l=o<10?"0"+o.toFixed(1):o.toFixed(1);let T,m,c="E"+r+"\xb0"+s+"\u2032"+l+"\u2033",u=~~e.lat,i=~~(60*(e.lat-u)),h=N.round(60*(60*(e.lat-u)-i),1);return h>=60&&(i+=1,h-=60),i>=60&&(u+=1,i-=60),T=i<10?"0"+i:""+i,m=h<10?"0"+h.toFixed(1):h.toFixed(1),new re(c,"N"+u+"\xb0"+T+"\u2032"+m+"\u2033")}static lnglat2ENPointObj(e){let r=~~e.lng,n=~~(60*(e.lng-r)),o=N.round(60*(60*(e.lng-r)-n),3);o>=60&&(n+=1,o-=60),n>=60&&(r+=1,n-=60);let s=~~e.lat,l=~~(60*(e.lat-s)),u=N.round(60*(60*(e.lat-s)-l),3);return u>=60&&(l+=1,u-=60),l>=60&&(s+=1,l-=60),new ne({h:r,m:n,s:Number(o)},{h:s,m:l,s:Number(u)})}static ENPoint2lnglat(e){let r=-1==e.lng.indexOf("E")?e.lng.split("E")[0]:e.lng.split("E")[1],n=parseInt(r.split("\xb0")[0]),a=parseFloat(r.split("\xb0")[1].split("\u2032")[0])/60,o=parseFloat(r.split("\xb0")[1].split("\u2032")[1].split("\u2033")[0])/3600,s=parseFloat((n+a+o).toFixed(6)),l=-1==e.lat.indexOf("N")?e.lat.split("N")[0]:e.lat.split("N")[1],c=parseInt(l.split("\xb0")[0]),u=parseFloat(l.split("\xb0")[1].split("\u2032")[0])/60,i=parseFloat(l.split("\xb0")[1].split("\u2032")[1].split("\u2033")[0])/3600,p=parseFloat((c+u+i).toFixed(6));return new d(s,p)}static LngLat_To_Mercator(e){let r=20037508.34*e.lng/180,n=Math.log(Math.tan((90+e.lat)*Math.PI/360))/(Math.PI/180);return n=20037508.34*n/180,new d(r,n)}static Mercator_To_LngLat(e){let r=e.lng/20037508.34*180,n=e.lat/20037508.34*180;return n=180/Math.PI*(2*Math.atan(Math.exp(n*Math.PI/180))-Math.PI/2),new d(r,n)}static wgs84_To_gcj02(e){let r=+e.lat,n=+e.lng;if(this.outOfChina(e))return e;{let a=this.transformLat(new d(n-105,r-35)),o=this.transformLng(new d(n-105,r-35)),s=r/180*this.PI,l=Math.sin(s);l=1-this.ee*l*l;let c=Math.sqrt(l);return a=180*a/(this.a*(1-this.ee)/(l*c)*this.PI),o=180*o/(this.a/c*Math.cos(s)*this.PI),new d(n+o,r+a)}}static gcj02_To_wgs84(e){let r=+e.lat,n=+e.lng;if(this.outOfChina(e))return e;{let a=this.transformLat(new d(n-105,r-35)),o=this.transformLng(new d(n-105,r-35)),s=r/180*this.PI,l=Math.sin(s);l=1-this.ee*l*l;let c=Math.sqrt(l);return a=180*a/(this.a*(1-this.ee)/(l*c)*this.PI),o=180*o/(this.a/c*Math.cos(s)*this.PI),new d(2*n-(n+o),2*r-(r+a))}}static transformLat(e){let r=+e.lat,n=+e.lng,a=2*n-100+3*r+.2*r*r+.1*n*r+.2*Math.sqrt(Math.abs(n));return a+=2*(20*Math.sin(6*n*this.PI)+20*Math.sin(2*n*this.PI))/3,a+=2*(20*Math.sin(r*this.PI)+40*Math.sin(r/3*this.PI))/3,a+=2*(160*Math.sin(r/12*this.PI)+320*Math.sin(r*this.PI/30))/3,a}static transformLng(e){let r=+e.lat,n=+e.lng,a=300+n+2*r+.1*n*n+.1*n*r+.1*Math.sqrt(Math.abs(n));return a+=2*(20*Math.sin(6*n*this.PI)+20*Math.sin(2*n*this.PI))/3,a+=2*(20*Math.sin(n*this.PI)+40*Math.sin(n/3*this.PI))/3,a+=2*(150*Math.sin(n/12*this.PI)+300*Math.sin(n/30*this.PI))/3,a}static outOfChina(e){let r=+e.lat,n=+e.lng;return!(n>73.66&&n<135.05&&r>3.86&&r<53.55)}static getDistance(e,r){let n,a,o,s;return e.lng=this.getLoop(e.lng,-180,180),e.lat=this.getRange(e.lat,-74,74),r.lng=this.getLoop(r.lng,-180,180),r.lat=this.getRange(r.lat,-74,74),n=this.degToRad(e.lng),o=this.degToRad(e.lat),a=this.degToRad(r.lng),s=this.degToRad(r.lat),this.a*Math.acos(Math.sin(o)*Math.sin(s)+Math.cos(o)*Math.cos(s)*Math.cos(a-n))}static degToRad(e){return Math.PI*e/180}static radToDeg(e){return 180*e/Math.PI}static getRange(e,r,n){return null!=r&&(e=Math.max(e,r)),null!=n&&(e=Math.min(e,n)),e}static getLoop(e,r,n){for(;e>n;)e-=n-r;for(;e<r;)e+=n-r;return e}static getCircularArcPoints(e,r,n,a){let o=a,l=e,c=r,u=new Array;for(let i=l;i<c+.001;i+=3){let p=this.EOffsetBearing(n,o,90-i);u.push(new d(p.lng,p.lat))}return u}static EOffsetBearing(e,r,n){let a=10*this.getDistance(e,new d(e.lng+.1,e.lat)),o=10*this.getDistance(e,new d(e.lng,e.lat+.1)),s=r*Math.sin(n*Math.PI/180)/o,l=r*Math.cos(n*Math.PI/180)/a;return new d(e.lng+l,e.lat+s)}static isPointInPolygon(e,r){let c,u,n=r,a=r.length,o=!0,s=0,l=this.PRECISION,i=e;c=n[0];for(let p=0;p<r.length;p++)if(Math.abs(i.lng-n[p].lng)<=l&&Math.abs(i.lat-n[p].lat)<=l)return o;for(let p=1;p<=a;++p)if(u=n[p%a],i.lat<Math.min(c.lat,u.lat)||i.lat>Math.max(c.lat,u.lat))c=u;else{if(i.lat>Math.min(c.lat,u.lat)&&i.lat<Math.max(c.lat,u.lat)){if(i.lng<=Math.max(c.lng,u.lng)){if(c.lat==u.lat&&i.lng>=Math.min(c.lng,u.lng))return o;if(c.lng==u.lng){if(c.lng==i.lng)return o;++s}else{let h=(i.lat-c.lat)*(u.lng-c.lng)/(u.lat-c.lat)+c.lng;if(Math.abs(i.lng-h)<l)return o;i.lng<h&&++s}}}else if(i.lat==u.lat&&i.lng<=u.lng){let h=n[(p+1)%a];i.lat>=Math.min(c.lat,h.lat)&&i.lat<=Math.max(c.lat,h.lat)?++s:s+=2}c=u}return s%2!=0}static destinationVincenty(e,r,n){let a={a:this.a,b:6356752.3142,f:.0033528106647474805},o=a.a,s=a.b,l=a.f,c=e.lng,u=e.lat,i=n,p=this.degToRad(r),h=Math.sin(p),T=Math.cos(p),m=(1-l)*Math.tan(this.degToRad(u)),f=1/Math.sqrt(1+m*m),b=m*f,_=Math.atan2(m,T),M=f*h,v=1-M*M,x=v*(o*o-s*s)/(s*s),Lt=1+x/16384*(4096+x*(x*(320-175*x)-768)),be=x/1024*(256+x*(x*(74-47*x)-128)),E=i/(s*Lt),Ot=2*Math.PI,L=0,O=0,Y=0;for(;Math.abs(E-Ot)>1e-12;)L=Math.cos(2*_+E),O=Math.sin(E),Y=Math.cos(E),Ot=E,E=i/(s*Lt)+be*O*(L+be/4*(Y*(2*L*L-1)-be/6*L*(4*O*O-3)*(4*L*L-3)));let At=b*O-f*Y*T,ul=Math.atan2(b*Y+f*O*T,(1-l)*Math.sqrt(M*M+At*At)),gl=Math.atan2(O*h,f*Y-b*O*T),Te=l/16*v*(4+l*(4-3*v));return new d(c+this.radToDeg(gl-(1-Te)*l*M*(E+Te*O*(L+Te*Y*(2*L*L-1)))),this.radToDeg(ul))}static getNorthByPointAB(e,r){let n=new d(e.lng,r.lat),a=this.getDistance(e,r),o=this.getDistance(r,n);if(e.lng==r.lng&&e.lat==r.lat)return 0;if(e.lng<=r.lng&&e.lat<=r.lat){if(o<a){let s=Math.asin(o/a);return this.radToDeg(s)}return 90}if(e.lng<=r.lng&&e.lat>r.lat){if(o<a){let s=Math.asin(o/a);return 180-this.radToDeg(s)}return 90}if(e.lng>=r.lng&&e.lat>=r.lat){if(o<a){let s=Math.asin(o/a);return 180+this.radToDeg(s)}return 270}if(e.lng>=r.lng&&e.lat<r.lat){if(o<a){let s=Math.asin(o/a);return 360-this.radToDeg(s)}return 270}return 0}}y.x_PI=52.35987755982988,y.PI=3.141592653589793,y.a=6378245,y.ee=.006693421622965943,y.EARTH_RADIUS=y.a,y.PRECISION=5e-5;class ye{static setFitViewByFeatures(e){if(null==e.features||0==e.features.length)return;let r=[];for(let n=0;n<e.features.length;n++){let a=e.features[n].getGeometry();null!=a&&r.push(a)}this.setFitViewByShapes({map:e.map,shapes:r,padding:e.padding})}static setFitViewByShapes(e){if(null==e.shapes||0==e.shapes.length)return;let r={minS:new Array,maxS:new Array};for(let i=0;i<e.shapes.length;i++)switch(e.shapes[i].constructor){case ol.geom.LineString:{let h=e.shapes[i].getCoordinates(),T=0,m=0,f=0,b=0;for(let _=0;_<h.length;_++)T=T?T>h[_][0]?h[_][0]:T:h[_][0],m=m?m>h[_][1]?h[_][1]:m:h[_][1],f=f?f<h[_][0]?h[_][0]:f:h[_][0],b=b?b<h[_][1]?h[_][1]:b:h[_][1];r.minS.push(new d(T,m)),r.maxS.push(new d(f,b));break}case ol.geom.Polygon:{let h=e.shapes[i].getCoordinates();for(let T=0;T<h.length;T++){let m=h[T],f=0,b=0,_=0,M=0;for(let v=0;v<m.length;v++)f=f?f>m[v][0]?m[v][0]:f:m[v][0],b=b?b>m[v][1]?m[v][1]:b:m[v][1],_=_?_<m[v][0]?m[v][0]:_:m[v][0],M=M?M<m[v][1]?m[v][1]:M:m[v][1];r.minS.push(new d(f,b)),r.maxS.push(new d(_,M))}break}case ol.geom.Circle:{let p=e.shapes[i],h=p.getCenter(),T=y.Mercator_To_LngLat(new d(h[0],h[1])),m=p.getRadius(),f=Math.sqrt(2*Math.pow(m,2)),b=y.destinationVincenty(T,225,f),_=y.destinationVincenty(T,45,f);r.minS.push(y.LngLat_To_Mercator(b)),r.maxS.push(y.LngLat_To_Mercator(_));break}}let n=0,a=0,o=0,s=0;for(let i=0;i<r.minS.length;i++)n=n?n>r.minS[i].lng?r.minS[i].lng:n:r.minS[i].lng,a=a?a>r.minS[i].lat?r.minS[i].lat:a:r.minS[i].lat;for(let i=0;i<r.maxS.length;i++)o=o?o<r.maxS[i].lng?r.maxS[i].lng:o:r.maxS[i].lng,s=s?s<r.maxS[i].lat?r.maxS[i].lat:s:r.maxS[i].lat;let l=[n,a,o,s],c=e.map.getOlMap().getView(),u=e.map.getOlMap().getSize();null!=u&&(u[0]<100&&(u[0]=100),u[1]<100&&(u[1]=100)),c.fit(l,{nearest:!1,padding:e.padding,size:u})}static setFitView(e){let r=e.map.getOlMap().getView(),n=y.LngLat_To_Mercator(e.extent.bottomLeft),a=y.LngLat_To_Mercator(e.extent.topRight);r.fit([n.lng,n.lat,a.lng,a.lat],{nearest:!1,padding:e.padding})}static addOverlay(e,r){e.getOlMap().addOverlay(r)}static addOverlays(e,r){for(let n=0;n<r.length;n++)e.getOlMap().addOverlay(r[n])}static removeOverlay(e,r){e.getOlMap().removeOverlay(r)}static removeOverlays(e,r){for(let n=0;n<r.length;n++)e.getOlMap().removeOverlay(r[n])}static removeAllOverlays(e){let r=e.getOlMap().getOverlays().getArray();this.removeOverlays(e,r)}static addFeature(e,r,n){let a=e.getLayerByName(r).getSource();a.hasFeature(n)||a.addFeature(n)}static addFeatures(e,r,n){let a=e.getLayerByName(r).getSource();for(let o=0;o<n.length;o++)a.hasFeature(n[o])||a.addFeature(n[o])}static removeFeature(e,r,n){let a=e.getLayerByName(r).getSource();a.hasFeature(n)&&a.removeFeature(n)}static removeFeatures(e,r,n){let a=e.getLayerByName(r).getSource();for(let o=0;o<n.length;o++)a.hasFeature(n[o])&&a.removeFeature(n[o])}static removeAllFeatures(e,r){e.getLayerByName(r).getSource().clear()}}const Nt="rgba(50, 138, 288, 0.3)",Mt="rgba(0, 90, 200, 1)";class Vi{constructor(e,r){this.mapSource=new Yi(ol),this.currentXyzName="",this.drawLayerName="vector-draw",this.drawType="Polygon",this.mapConfig=e.option,this.initMap(e,r).then(n=>{r.onFinish(n)})}getOlMap(){return this.mapObj}setMapConfig(e){this.mapConfig=e}getMapConfig(){return this.mapConfig}initMap(e,r){let n=[],a=this.mapSource.layers.get(e.option.layer);for(let c=0;c<a.length;c++){let u=new ol.layer.Tile({source:a[c].source,zIndex:0});u.setProperties({name:a[c].name}),n.push(u)}this.currentXyzName=e.option.layer;let o=new ol.layer.Tile({source:new ol.source.TileDebug,visible:e.option.grid,zIndex:50});n.push(o),this.gridLayer=o;let s=new ol.source.Vector,l=new ol.layer.Vector({source:s,zIndex:21,style:new ol.style.Style({fill:new ol.style.Fill({color:Nt}),stroke:new ol.style.Stroke({color:Mt,width:2}),image:new ol.style.Circle({radius:7,fill:new ol.style.Fill({color:"#ffcc33"})})})});return l.setProperties({name:this.drawLayerName}),n.push(l),this.drawLayer=l,this.drawSource=s,this.mapObj=new ol.Map({target:e.dom,layers:n,view:new ol.View({projection:"EPSG:3857",center:ol.proj.fromLonLat([105.203317,37.506176]),zoom:4,maxZoom:21,minZoom:0}),interactions:[new ol.interaction.DragPan,new ol.interaction.PinchZoom,new ol.interaction.KeyboardPan,new ol.interaction.KeyboardZoom,new ol.interaction.MouseWheelZoom,new ol.interaction.DragZoom],controls:[new ol.control.ScaleLine]}),this.mapEle=e.dom,this.mapObj.on("click",c=>{if(null==this.mapObj)return;let u=0;this.mapObj.forEachFeatureAtPixel(c.pixel,i=>{u+=1,i.dispatchEvent("click")})}),elementResizeDetectorMaker().listenTo(this.mapEle,c=>{setTimeout(()=>{this.mapObj?.setSize([c.offsetWidth,c.offsetHeight]),this.mapObj?.getView().setViewportSize([c.offsetWidth,c.offsetHeight]),r.onResize&&r.onResize(c)})}),new Promise(c=>{setTimeout(()=>{c({success:!0,msg:"\u5730\u56fe\u52a0\u8f7d\u5b8c\u6210"})})})}destroyMap(){elementResizeDetectorMaker().uninstall(this.mapEle)}zoomIn(){if(null!=this.mapObj){let e=this.mapObj.getView().getZoom();null!=e&&this.mapObj.getView().setZoom(e+1)}}zoomOut(){if(null!=this.mapObj){let e=this.mapObj.getView().getZoom();null!=e&&this.mapObj.getView().setZoom(e-1)}}setMaxZoom(e){null!=this.mapObj&&this.mapObj.getView().setMaxZoom(e)}getCurrentCoordinateType(){return this.mapSource.layers.get(this.currentXyzName)[0].coordinateType}getCurrentXyzUrlResources(){let e=N.needKey(this.getCurrentXyzName()).type,r=N.needKey(this.getCurrentXyzName()).has,n=[],a=this.mapSource.layers.get(this.currentXyzName);for(let o=0;o<a.length;o++)if("XYZ_URL"===a[o].type){let s=a[o].url;if(r){let l=N.getConfigCache();n.push("tian"==e?s.replace("&&&&&&&key&&&&&&&",l.key[e]):s)}else n.push(s)}return n}getCurrentXyzName(){return this.currentXyzName}getLayerByName(e){if(null==this.mapObj)return null;let r=this.mapObj.getLayers().getArray();for(let n=0;n<r.length;n++)if(e==r[n].getProperties().name)return r[n];return null}getLayerVisibleByName(e){let r=this.getLayerByName(e);return!!r&&r.getVisible()}showGrid(){this.gridLayer&&this.gridLayer.setVisible(!0)}closeGrid(){this.gridLayer&&this.gridLayer.setVisible(!1)}getGridVisible(){return null!=this.gridLayer&&this.gridLayer.getVisible()}setFitviewFromDrawLayer(){if(null==this.mapObj)return;let e=this.getLayerByName(this.drawLayerName);if(null==e)return;let r=e.getSource();ye.setFitViewByFeatures({map:this,features:r.getFeatures(),padding:[32,32,32,32]})}switchMapResource(e){if(null==this.mapObj)return;let r=this.mapSource.layers.get(this.currentXyzName);for(let a=0;a<r.length;a++){let o=this.getLayerByName(r[a].name);o&&this.mapObj.removeLayer(o)}let n=this.mapSource.layers.get(e);for(let a=0;a<n.length;a++){let o=new ol.layer.Tile({source:n[a].source,zIndex:0});o.setProperties({name:n[a].name}),this.mapObj.addLayer(o)}this.currentXyzName=e}turnMapFeaturesFromWgs84ToGcj02(){if(null==this.drawSource)return;let e=this.drawSource.getFeatures();if(null!=e&&e.length>0)for(let r=0;r<e.length;r++){let a=e[r].getGeometry();if(null!=a)switch(a.constructor){case ol.geom.Polygon:{let o=a,s=o.getCoordinates()[0],l=[];for(let i=0;i<s.length;i++)l.push(y.Mercator_To_LngLat(new d(s[i][0],s[i][1])));let c=[];for(let i=0;i<l.length;i++)c.push(y.wgs84_To_gcj02(new d(l[i].lng,l[i].lat)));let u=[];for(let i=0;i<c.length;i++)u.push(ol.proj.fromLonLat([c[i].lng,c[i].lat]));o.setCoordinates([u]);break}case ol.geom.Circle:{let o=a,s=o.getCenter(),l=y.Mercator_To_LngLat(new d(s[0],s[1])),c=y.wgs84_To_gcj02(new d(l.lng,l.lat)),u=ol.proj.fromLonLat([c.lng,c.lat]);o.setCenter(u);break}}}}turnMapFeaturesFromGcj02ToWgs84(){if(null==this.drawSource)return;let e=this.drawSource.getFeatures();if(null!=e&&e.length>0)for(let r=0;r<e.length;r++){let a=e[r].getGeometry();if(null!=a)switch(a.constructor){case ol.geom.Polygon:{let o=a,s=o.getCoordinates()[0],l=[];for(let i=0;i<s.length;i++)l.push(y.Mercator_To_LngLat(new d(s[i][0],s[i][1])));let c=[];for(let i=0;i<l.length;i++)c.push(y.gcj02_To_wgs84(new d(l[i].lng,l[i].lat)));let u=[];for(let i=0;i<c.length;i++)u.push(ol.proj.fromLonLat([c[i].lng,c[i].lat]));o.setCoordinates([u]);break}case ol.geom.Circle:{let o=a,s=o.getCenter(),l=y.Mercator_To_LngLat(new d(s[0],s[1])),c=y.gcj02_To_wgs84(new d(l.lng,l.lat)),u=ol.proj.fromLonLat([c.lng,c.lat]);o.setCenter(u);break}}}}setDrawType(e){this.drawType=e}openDraw(e){switch(this.drawType){case"Polygon":this.openPolygonDraw(e);break;case"Circle":this.openCircleDraw(e)}}getDrawedPoints(){let e=[],r=this.drawSource?.getFeatures();if(null!=r&&r.length>0)for(let n=0;n<r.length;n++){let o=r[n].getGeometry();if(null!=o)switch(o.constructor){case ol.geom.Polygon:{let s=o.getCoordinates()[0];null!=s&&s.length>3&&e.push(s);break}case ol.geom.Circle:{let s=o.getCenter(),l=o.getRadius(),c=y.getCirclePoints(y.Mercator_To_LngLat(new d(s[0],s[1])),l),u=[];for(let i=0;i<c.length;i++){let p=y.LngLat_To_Mercator(c[i]);u.push([p.lng,p.lat])}e.push(u);break}}}return e}getDrawedPointsString(){let e=this.getDrawedPoints();return 0==e.length?"":JSON.stringify(e)}openPolygonDraw(e){if(null==this.mapObj||null==this.drawSource)return;this.removeModifyInteraction(),this.removeDrawInteraction(),this.removeSnapInteraction();let r=new ol.interaction.Modify({source:this.drawSource}),n=new ol.interaction.Draw({source:this.drawSource,type:"Polygon"}),a=new ol.interaction.Snap({source:this.drawSource});r.on("modifyend",()=>{e.modifyEnd()}),n.on("drawend",()=>{e.drawEnd()}),this.mapObj.addInteraction(r),this.mapObj.addInteraction(n),this.mapObj.addInteraction(a),this.modifyInteraction=r,this.drawInteraction=n,this.snapInteraction=a}openCircleDraw(e){if(null==this.mapObj)return;this.removeModifyInteraction(),this.removeDrawInteraction(),this.removeSnapInteraction();let r=new ol.interaction.Modify({source:this.drawSource}),n=new ol.interaction.Draw({source:this.drawSource,type:"Circle"}),a=new ol.interaction.Snap({source:this.drawSource});r.on("modifyend",()=>{e.modifyEnd()}),n.on("drawend",()=>{e.drawEnd()}),this.mapObj.addInteraction(r),this.mapObj.addInteraction(n),this.mapObj.addInteraction(a),this.modifyInteraction=r,this.drawInteraction=n,this.snapInteraction=a}getDrawedFeatures(){if(null!=this.drawSource)return this.drawSource.getFeatures()}removeDrawedFeatures(){ye.removeAllFeatures(this,this.drawLayerName)}removeModifyInteraction(){null!=this.mapObj&&null!=this.modifyInteraction&&(this.mapObj.removeInteraction(this.modifyInteraction),this.modifyInteraction=void 0)}removeDrawInteraction(){null!=this.mapObj&&null!=this.drawInteraction&&(this.mapObj.removeInteraction(this.drawInteraction),this.drawInteraction=void 0)}removeSnapInteraction(){null!=this.mapObj&&null!=this.snapInteraction&&(this.mapObj.removeInteraction(this.snapInteraction),this.snapInteraction=void 0)}pan(){this.removeModifyInteraction(),this.removeDrawInteraction(),this.removeSnapInteraction()}}var vt=C(185),g=C(4650),Ki=C(2720);let Ct=(()=>{class t{constructor(r){this.http=r}blockDownload(r){return this.http.request({method:vt.w.POST,url:"/submit/blockDownload",data:r})}worldDownload(r){return this.http.request({method:vt.w.POST,url:"/submit/worldDownload",data:r})}}return t.\u0275fac=function(r){return new(r||t)(g.LFG(Ki.Y))},t.\u0275prov=g.Yz7({token:t,factory:t.\u0275fac}),t})();class Wi{static createPolygonFeature(e){let r=[];for(let s=0;s<e.length;s++)r.push(ol.proj.fromLonLat([e[s].lng,e[s].lat]));let n=new ol.geom.Polygon([r]),a=new ol.Feature({geometry:n}),o=new ol.style.Style({stroke:new ol.style.Stroke({color:Mt,width:3}),fill:new ol.style.Fill({color:Nt})});return a.setStyle(o),a}}class Hi{constructor(e,r,n,a){this.mqClient=e,this.submitService=r,this.mapBase=n,this.mapPage=a,e.sub("ZoomIn").subscribe(o=>{n.zoomIn()}),e.sub("ZoomOut").subscribe(o=>{n.zoomOut()}),e.sub("Pan").subscribe(o=>{n.pan()}),e.sub("GridSwitch").subscribe(o=>{let s;n.getGridVisible()?(n.closeGrid(),s=!1):(n.showGrid(),s=!0);let l=n.getMapConfig();l&&(l.grid=s,N.setConfigCache(l),n.setMapConfig(l))}),e.sub("SwitchResource").subscribe(o=>{let s=n.getCurrentCoordinateType();n.switchMapResource(o);let l=n.getCurrentCoordinateType(),c=n.getMapConfig();c&&(c.layer=o,N.setConfigCache(c),n.setMapConfig(c)),s!=l&&("wgs84"==s&&"gcj02"==l?n.turnMapFeaturesFromWgs84ToGcj02():"gcj02"==s&&"wgs84"==l&&n.turnMapFeaturesFromGcj02ToWgs84()),setTimeout(()=>{a.updateShowInfo()})}),e.sub("SwitchDrawType").subscribe(o=>{n.setDrawType(o)}),e.sub("OpenDraw").subscribe(o=>{n.pan(),n.removeDrawedFeatures(),n.openDraw({drawEnd:()=>{setTimeout(()=>{n.removeDrawInteraction()})},modifyEnd:()=>{}})}),e.sub("DrawPolygonAndPositioning").subscribe(o=>{n.pan(),n.removeDrawedFeatures();let s=JSON.parse(o);for(let l=0;l<s.length;l++){let c=[];for(let i=0;i<s[l].length;i++){let p=new d(s[l][i].lng,s[l][i].lat);"wgs84"==n.getCurrentCoordinateType()?c.push(y.gcj02_To_wgs84(p)):c.push(p)}let u=Wi.createPolygonFeature(c);ye.addFeature(n,n.drawLayerName,u)}n.setFitviewFromDrawLayer()}),e.sub("Fitview").subscribe(o=>{n.setFitviewFromDrawLayer()}),e.sub("RemoveDrawedShape").subscribe(o=>{n.removeDrawedFeatures()}),e.sub("SubmitBlockDownload").subscribe(o=>{let s={tileName:this.mapBase?.getCurrentXyzName(),mapType:N.getMapType(this.mapBase?.getCurrentXyzName()),tileUrl:this.mapBase?.getCurrentXyzUrlResources(),points:this.mapBase?.getDrawedPoints()};this.submitService.blockDownload(s).then(l=>{})}),e.sub("SubmitWorldDownload").subscribe(o=>{let s={tileName:this.mapBase?.getCurrentXyzName(),mapType:N.getMapType(this.mapBase?.getCurrentXyzName()),tileUrl:this.mapBase?.getCurrentXyzUrlResources()};this.submitService.worldDownload(s).then(l=>{})})}}var Ji=C(8138),Qi=C(6616),$i=C(7044),qi=C(1664),jt=C(3679),ae=C(6704),el=C(5635),It=C(6960);const tl=["map"],rl=["mapTypeDiv"],nl=["coordinateTypeDiv"],al=["changeKeyDiv"];function sl(t,e){if(1&t&&(g.ynx(0),g.TgZ(1,"form",13)(2,"nz-form-item")(3,"nz-form-label",14),g._uU(4,"Key"),g.qZA(),g.TgZ(5,"nz-form-control",15),g._UZ(6,"input",16),g.qZA()()(),g.BQk()),2&t){const r=g.oxw();g.xp6(1),g.Q6J("formGroup",r.validateForm),g.xp6(2),g.Q6J("nzSpan",6),g.xp6(2),g.Q6J("nzSpan",14)}}const il=[{path:"",component:(()=>{class t{constructor(r,n,a){this.fb=r,this.innerMqService=n,this.submitService=a,this.zoom=0,this.keyType="",this.isChangeKeyModalVisible=!1}ngOnInit(){let r=this.innerMqService.createConnect("MapPage");if(this.validateForm=this.fb.group({key:[null,[I.kI.required]]}),null!=this.mapEleRef){let n=N.getConfigCache();this.mapBase=new Vi({dom:this.mapEleRef.nativeElement,option:n},{onFinish:()=>{new Hi(r,this.submitService,this.mapBase,this),this.mapInitFinish()},onResize:a=>{this.mapAutoSize(a)}})}}ngOnDestroy(){this.innerMqService.destroyClient("MapPage")}mapInitFinish(){this.mapBase.getOlMap().on("moveend",r=>{let n=r.map.getView().getZoom();null!=n&&(this.zoom=Math.round(n))}),this.updateShowInfo()}updateShowInfo(){if(null==this.mapBase||null==this.changeKeyDiv||null==this.mapTypeDiv||null==this.coordinateTypeDiv)return;this.keyType=N.needKey(this.mapBase.getCurrentXyzName()).type;let r=N.needKey(this.mapBase.getCurrentXyzName()).has,n=N.getMapType(this.mapBase.getCurrentXyzName()),a=this.mapBase.getCurrentCoordinateType();this.changeKeyDiv.nativeElement.style.display=r?"block":"none",this.mapTypeDiv.nativeElement.innerText=n,this.coordinateTypeDiv.nativeElement.innerText="\u5750\u6807\u7c7b\u578b\uff1a"+a}openChangeKeyModal(){"tian"==this.keyType&&(this.validateForm.controls.key.setValue(N.getConfigCache().key[this.keyType]),this.isChangeKeyModalVisible=!0)}closeChangeKeyModal(){this.isChangeKeyModalVisible=!1}keyFormValid(){for(const r in this.validateForm.controls)this.validateForm.controls[r].markAsDirty(),this.validateForm.controls[r].updateValueAndValidity();return this.validateForm.valid}changeKey(){if("tian"==this.keyType&&this.keyFormValid()){let r=this.validateForm.controls.key.value,n=N.getConfigCache();n.key[this.keyType]=r,N.setConfigCache(n),this.reload()}}reload(){window.location.reload()}mapAutoSize(r){let n=r.offsetWidth,a=r.offsetHeight;this.mapBase?.getOlMap()?.setSize([n,a])}}return t.\u0275fac=function(r){return new(r||t)(g.Y36(I.qu),g.Y36(Ji.X),g.Y36(Ct))},t.\u0275cmp=g.Xpm({type:t,selectors:[["app-map"]],viewQuery:function(r,n){if(1&r&&(g.Gf(tl,7),g.Gf(rl,7),g.Gf(nl,7),g.Gf(al,7)),2&r){let a;g.iGM(a=g.CRH())&&(n.mapEleRef=a.first),g.iGM(a=g.CRH())&&(n.mapTypeDiv=a.first),g.iGM(a=g.CRH())&&(n.coordinateTypeDiv=a.first),g.iGM(a=g.CRH())&&(n.changeKeyDiv=a.first)}},features:[g._Bn([Ct])],decls:23,vars:2,consts:[[1,"map"],["map",""],[1,"zoom"],[1,"right-top"],[1,"btn"],["changeKeyDiv",""],["nz-button","","nzSize","small","nzType","primary",3,"click"],["nz-button","","nzSize","small","nzType","default"],["mapTypeDiv",""],[1,"right-bottom"],["coordinateTypeDiv",""],["nzTitle","\u66f4\u6362Key",3,"nzVisible","nzOnCancel","nzOnOk"],[4,"nzModalContent"],["nz-form","",3,"formGroup"],["nzRequired","",3,"nzSpan"],["nzErrorTip","\u8bf7\u8f93\u5165Key",3,"nzSpan"],["nz-input","","formControlName","key","placeholder","\u8bf7\u8f93\u5165Key"]],template:function(r,n){1&r&&(g._UZ(0,"div",0,1),g.TgZ(2,"div",2),g._uU(3),g.qZA(),g.TgZ(4,"div",3)(5,"div",4,5)(7,"button",6),g.NdJ("click",function(){return n.openChangeKeyModal()}),g._uU(8,"\u66f4\u6362Key"),g.qZA()(),g.TgZ(9,"div",4)(10,"button",6),g.NdJ("click",function(){return n.reload()}),g._uU(11,"\u5237\u65b0"),g.qZA()(),g.TgZ(12,"div",4)(13,"button",7),g._UZ(14,"div",null,8),g.qZA()()(),g.TgZ(16,"div",9)(17,"div",4)(18,"button",7),g._UZ(19,"div",null,10),g.qZA()()(),g.TgZ(21,"nz-modal",11),g.NdJ("nzOnCancel",function(){return n.closeChangeKeyModal()})("nzOnOk",function(){return n.changeKey()}),g.YNc(22,sl,7,3,"ng-container",12),g.qZA()),2&r&&(g.xp6(3),g.hij("Zoom:\xa0",n.zoom,""),g.xp6(18),g.Q6J("nzVisible",n.isChangeKeyModalVisible))},dependencies:[I._Y,I.Fj,I.JJ,I.JL,I.sg,I.u,Qi.ix,$i.w,qi.dQ,jt.t3,jt.SK,ae.Lr,ae.Nx,ae.iK,ae.Fd,el.Zp,It.du,It.Hf],styles:[".map[_ngcontent-%COMP%]{width:100%;height:100%}.zoom[_ngcontent-%COMP%]{position:absolute;top:8px;left:8px;padding:3px 5px;border-radius:4px;background:rgba(0,60,136,.4);color:#eee;font-size:14px;text-align:center;-webkit-user-select:none;user-select:none}.right-top[_ngcontent-%COMP%]{position:absolute;top:8px;right:8px}.right-top[_ngcontent-%COMP%]   .btn[_ngcontent-%COMP%]{float:left;margin-left:8px}.right-bottom[_ngcontent-%COMP%]{position:absolute;bottom:8px;right:8px}.right-bottom[_ngcontent-%COMP%]   .btn[_ngcontent-%COMP%]{float:left;margin-left:8px}"]}),t})()}];let ll=(()=>{class t{}return t.\u0275fac=function(r){return new(r||t)},t.\u0275mod=g.oAB({type:t}),t.\u0275inj=g.cJS({imports:[we.Bz.forChild(il),we.Bz]}),t})(),cl=(()=>{class t{}return t.\u0275fac=function(r){return new(r||t)},t.\u0275mod=g.oAB({type:t}),t.\u0275inj=g.cJS({imports:[xt.ez,ll,I.u5,I.UX,Pt.b]}),t})()}}]);